---
## Front matter
title: "Отчёт по лабораторной работе №14"
subtitle: "Партиции, файловые системы, монтирование"
author: "Эзиз Хатамов"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получить навыки создания разделов на диске и файловых систем. Получить навыки монтирования файловых систем.

# Отчёт по выполнению работы
  
## Создание разделов MBR с помощью fdisk

### Просмотр подключённых дисков

После запуска виртуальной машины был выполнен анализ подключённых устройств хранения.  
В списке появились дополнительные диски по 1.5 GiB — **/dev/sdb** и **/dev/sdc**, что подтверждает корректное подключение оборудования.

![Просмотр всех дисков с помощью fdisk -l](Screenshot_1.png){ #fig:001 width=80% }

### Создание основного раздела на диске /dev/sdb

1. Запуск утилиты разметки и просмотр справки команд.  
2. Проверка текущего состояния таблицы разделов: свободное место доступно полностью.  
3. Создание основного раздела:
   - тип: primary  
   - номер: 1  
   - первый сектор: по умолчанию  
   - размер: **300 MiB**  
4. Таблица разделов записана на диск.  

![Создание первичного раздела 300M](Screenshot_3.png){ #fig:003 width=80% }

Сравнение вывода `fdisk -l /dev/sdb` и `/proc/partitions` показало, что ядро ещё не видело новый раздел.  
После обновления таблицы командой **partprobe** устройство **sdb1** стало отображаться.

![Проверка раздела sdb1](Screenshot_4.png){ #fig:004 width=80% }

## Создание расширенного и логического разделов

1. Создание расширенного раздела:
   - тип: extended  
   - номер: 2  
   - использовано всё оставшееся свободное место  

2. Создание логического раздела внутри расширенного:
   - номер: 5  
   - размер: **300 MiB**

3. Запись изменений и обновление таблицы разделов ядра.  

![Создание расширенного и логического разделов](Screenshot_5.png){ #fig:005 width=80% }

Проверка вывода `/proc/partitions` и `fdisk -l /dev/sdb` подтвердила появление разделов **sdb2** и **sdb5**.

![Проверка разделов после создания sdb2 и sdb5](Screenshot_6.png){ #fig:006 width=80% }

## Создание раздела подкачки

1. Создание ещё одного логического раздела:
   - номер: 6  
   - размер: **300 MiB**

2. Изменение типа раздела на **82 (Linux swap)**.  
3. Запись изменений и обновление таблицы ядра.  

![Создание и изменение типа swap-раздела](Screenshot_7.png){ #fig:007 width=80% }

Далее раздел был подготовлен и активирован как пространство подкачки.  
Проверка показала успешное выделение swap-области.

![Форматирование, активация swap и итоговая проверка](Screenshot_8.png){ #fig:008 width=80% }

## Создание разделов GPT с помощью gdisk

Была выполнена проверка структуры диска **/dev/sdc**.  
Утилита сообщила, что существующая разметка отсутствует, и предложила создать новую таблицу GPT.

![Проверка диска /dev/sdc с помощью gdisk -l](Screenshot_9.png){ #fig:009 width=80% }

1. Запуск утилиты **gdisk** для диска /dev/sdc.  
2. Создание нового раздела:
   - команда **n**  
   - номер раздела по умолчанию: 1  
   - первый сектор: по умолчанию  
   - размер: **300 MiB**  
3. Тип раздела оставлен по умолчанию — **8300 (Linux filesystem)**.  
4. Просмотр таблицы перед записью показал корректное создание.  
5. Запись разметки на диск выполнена командой **w**.

![Создание раздела 300M в gdisk](Screenshot_10.png){ #fig:010 width=80% }

После записи таблицы разделов была обновлена информация ядра через **partprobe**, и новое устройство стало отображаться.

![Проверка разделов после partprobe](Screenshot_11.png){ #fig:011 width=80% }

## Форматирование файловых систем

### Файловая система XFS для /dev/sdb1

1. Создание файловой системы XFS.  
2. Присвоение метки **xfsdisk**.

![Форматирование XFS и назначение метки](Screenshot_12.png){ #fig:012 width=80% }

### Файловая система EXT4 для /dev/sdb5

1. Создание файловой системы EXT4.  
2. Установка метки **ext4disk**.  
3. Настройка параметров монтирования (ACL и расширенные атрибуты).

![Создание EXT4 и настройка параметров mount](Screenshot_13.png){ #fig:013 width=80% }

## Ручное монтирование файловых систем

1. Создана точка монтирования **/mnt/tmp**.  
2. Раздел **/dev/sdb5** был смонтирован, проверен и отмонтирован.

![Ручное монтирование и проверка](Screenshot_14.png){ #fig:014 width=80% }

## Монтирование разделов через /etc/fstab

1. Создана точка монтирования **/mnt/data**.  
2. Получены UUID всех устройств с помощью **blkid**.  
3. В файл **/etc/fstab** добавлена строка для автоматического монтирования раздела **/dev/sdb1** в каталог /mnt/data как XFS.  
4. Выполнена проверка конфигурации с помощью **mount -a**.  
5. Команда **df -h** показала успешное автоматическое монтирование.

![Получение UUID и проверка fstab](Screenshot_15.png){ #fig:015 width=80% }

![Автоматическое монтирование /dev/sdb1](Screenshot_16.png){ #fig:016 width=80% }

## Отчёт по выполнению самостоятельной работе  

Для выполнения задания был использован диск **/dev/sdc**, на котором уже присутствовала таблица GPT.  

Были созданы два новых раздела по **100 MiB** каждый:

- **/dev/sdc2** — тип 8300 (Linux filesystem), впоследствии отформатирован в EXT4  
- **/dev/sdc3** — тип 8200 (Linux swap)

Процесс создания разделов:

![Создание разделов через gdisk](Screenshot_17.png){ #fig:017 width=80% }

Создание файловой системы EXT4 и присвоение метки:

- метка: **ext4disk2**

Дополнительно настроены параметры монтирования:

- включены `acl` и `user_xattr`

Раздел **/dev/sdc3** был преобразован в swap с помощью:

- создание swap-подсистемы  
- проверка информации о swap-разделах

![Форматирование ext4 и создание swap](Screenshot_18.png){ #fig:018 width=80% }


После получения UUID всех разделов была произведена настройка файла `/etc/fstab`.

Были добавлены строки:

- для автоматического монтирования EXT4-раздела `/dev/sdc2` в каталог `/mnt/data-ext`
- для автоматической активации swap-области `/dev/sdc3`

Пример конфигурации:

![Настройка /etc/fstab](Screenshot_19.png){ #fig:019 width=80% }

После перезагрузки была проверена корректность:

- монтирования разделов  
- активации пространства подкачки  

Команды `mount`, `df -h` и `free -m` показали, что система корректно использует:

- `/dev/sdb1` (XFS) → `/mnt/data`
- `/dev/sdc2` (EXT4) → `/mnt/data-ext`
- `/dev/sdc3` → активный swap

![Проверка монтирования и swap](Screenshot_20.png){ #fig:020 width=80% }

# Контрольные вопросы

1. **Какой инструмент используется для создания разделов GUID?**  
   - Для разметки дисков с использованием схемы **GPT** используется утилита **gdisk**.  
   - Пример: `gdisk /dev/sdc`

2. **Какой инструмент применяется для создания разделов MBR?**  
   - Для разметки дисков в формате **MBR** используется утилита **fdisk**.  
   - Пример: `fdisk /dev/sdb`

3. **Какой файл используется для автоматического монтирования разделов во время загрузки?**  
   - Разделы автоматически монтируются согласно конфигурации в файле **/etc/fstab**.

4. **Какой вариант монтирования целесообразно выбрать, если необходимо, чтобы файловая система не была автоматически примонтирована во время загрузки?**  
   - Следует использовать опцию **noauto** в файле `/etc/fstab`.  
   - Пример строки: `UUID=<id> /mnt/data ext4 noauto 0 0`

5. **Какая команда позволяет форматировать раздел с типом 82 с соответствующей файловой системой?**  
   - Тип **82** означает раздел подкачки, и для его форматирования используется **mkswap**.  
   - Пример: `mkswap /dev/sdc3`

6. **Вы только что добавили несколько разделов для автоматического монтирования при загрузке. Как можно безопасно проверить, будет ли это работать без реальной перезагрузки?**  
   - Можно воспользоваться командой **mount -a**, которая монтирует все записи из `/etc/fstab`, кроме тех, где установлена опция *noauto*.

7. **Какая файловая система создаётся, если вы используете команду mkfs без какой-либо спецификации файловой системы?**  
   - По умолчанию команда `mkfs` создаёт файловую систему **ext2**.

8. **Как форматировать раздел EXT4?**  
   - Для создания файловой системы EXT4 используется команда **mkfs.ext4**.  
   - Пример: `mkfs.ext4 /dev/sdc2`

9. **Как найти UUID для всех устройств на компьютере?**  
   - Для получения UUID всех блочных устройств используется команда **blkid**.  
   - Пример: `blkid`

# Заключение

В ходе работы были изучены принципы разметки дисков с использованием схем MBR и GPT, создание основных и логических разделов, настройка файловых систем и области подкачки. Было освоено ручное и автоматическое монтирование разделов, а также работа с файлом `/etc/fstab` для обеспечения корректного подключения устройств при загрузке системы.
